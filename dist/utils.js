function p(t){let n;typeof t=="string"?n=t:t&&t.length?n=t.reduce((e,o)=>(e+=String.fromCharCode(o),e),""):t?n=t.toString():n="";try{return"__wb_post_data="+btoa(n)}catch{return"__wb_post_data="}}function x(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function U(t){try{if(!t.startsWith("https:")&&!t.startsWith("http:"))return t;t=t.replace(/^(https?:\/\/)www\d*\./,"$1");let n=t.toLowerCase(),e=new URL(n),i=e.hostname.split(".").reverse().join(",");if(e.port&&(i+=":"+e.port),i+=")",i+=e.pathname,e.search){e.searchParams.sort(),i+=e.search;for(let[a,r]of e.searchParams.entries())if(!r){let s=new RegExp(`(?<=[&?])${x(a)}=(?=&|$)`);s.exec(n)||(i=i.replace(s,a))}}return i}catch{return t}}function T(t){let{method:n,headers:e,postData:o}=t;if(n==="GET")return!1;let i=(e.get("content-type")||"").split(";")[0];function a(s){return s instanceof Uint8Array&&(s=new TextDecoder().decode(s)),s}let r="";switch(i){case"application/x-www-form-urlencoded":r=a(o);break;case"application/json":r=u(a(o));break;case"text/plain":try{r=u(a(o),!1)}catch{r=p(o)}break;case"multipart/form-data":{let s=e.get("content-type");if(!s)throw new Error("utils cannot call postToGetURL when missing content-type header");r=h(a(o),s);break}default:r=p(o)}return r!==null?(t.url=y(t.url,r,t.method),t.method="GET",t.requestBody=r,!0):!1}function y(t,n,e){if(!e)return t;let o=t.indexOf("?")>0?"&":"?";return`${t}${o}__wb_method=${e}&${n}`}function l(t,n=!0){if(typeof t=="string")try{t=JSON.parse(t)}catch{t={}}let e=new URLSearchParams,o={},i=r=>e.has(r)?(r in o||(o[r]=1),r+"."+ ++o[r]+"_"):r,a=(r,s="")=>{let f="";if(typeof r=="object"&&!(r instanceof Array))try{for(let[c,m]of Object.entries(r))a(m,c)}catch{r===null&&(f="null")}else if(r instanceof Array)for(let c=0;c<r.length;c++)a(r[c],s);["string","number","boolean"].includes(typeof r)&&(f=r.toString()),f&&e.set(i(s),f)};try{a(t)}catch(r){if(!n)throw r}return e}function g(t,n){let e=new URLSearchParams;t instanceof Uint8Array&&(t=new TextDecoder().decode(t));try{let o=n.split("boundary=")[1],i=t.split(new RegExp("-*"+o+"-*","mi"));for(let a of i){let r=a.trim().match(/name="([^"]+)"\r\n\r\n(.*)/im);r&&e.set(r[1],r[2])}}catch{}return e}function u(t,n=!0){return l(t,n).toString()}function h(t,n){return g(t,n).toString()}function A(t,n){if(t.length===1)return t[0];let e=new Uint8Array(n),o=0;for(let i of t)e.set(i,o),o+=i.byteLength;return e}function S(t,n){return[t.slice(0,n),t.slice(n)]}export{y as appendRequestQuery,A as concatChunks,U as getSurt,l as jsonToQueryParams,u as jsonToQueryString,g as mfdToQueryParams,h as mfdToQueryString,T as postToGetUrl,S as splitChunk};
